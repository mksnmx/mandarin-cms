---------
Установка
=========

1. Скопировать папку assets корень сайта.

2. В системе управления перейти "Элементы" -> "Управление элементами" -> "Сниппеты". Нажать ссылку "Новый сниппет".
 - Название сниппета: mandarin
 - Описание: Онлайн-оплата покупок

В код сниппета вставить следующий фрагмент:

<?php
$output = '';
$session_mid='merchantid';#id мерчанта
$session_msec='secret';#secret мерчанта
require_once "assets/snippets/mandarin/mandarin.inc.php";

return $output;
?>
*параметры $session_mid и $session_msec можно менять напрямую из настроек сниппета*
 - Нажать кнопку "Сохранить".

----------------------------------
Оплата.
==================================
1. В системе управления открыть для редактирования страницу, которая открывается после оформления заказа (&gotoid в eForm). В данном примере страница "Спасибо!".
Вставить в поле "Содержимое ресурса" вызов сниппета: 
[!mandarin!]
нажать продолжить и сохранить важно! не сохранить + закрыть а сохранить + продолжить.

В шаблоне формы (shopOrderForm находится в Чанках) должен быть выпадающий список (select) для выбора метода оплаты. Добавляем опцию с значением mandarin. Пример:

<select name="payment" >
  <option value="При получении">При получении</option>
  <option value="mandarin">Оплатить через MandarinBank</option>
</select>


После отправки заказа на следующей странице будет появляться форма оплаты.

----------------------------------
URL для платёжной системы
==================================
Снова найти в ModX страницу "спасибо!" - которая после оплаты. Допустим, её id=16

callbackURL http://%сайт%/assets/snippets/mandarin/callback.php
returnURL http://%сайт%/index.php?id=16
